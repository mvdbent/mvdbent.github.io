<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to use dockutil in a script | AppleShare IT</title><meta name=keywords content="Dock,macOS,Script,Bash,workflows,Jamf Pro"><meta name=description content="Now that dockutil has been rewritten in Swift for macOS 12.3 compatibility, I needed to dust off my scripts. dockutil is supporting macOS 11 Big Sur or higher.
Don&rsquo;t forget to look at the USAGE section in the readme or use the --help option to read more about the usage and options.
Luckily, not much is needed to be dusted off. However, I wanted to add some adjustments and share my workflows which you can use within Jamf."><meta name=author content><link rel=canonical href=https://appleshare.it/posts/use-dockutil-in-a-script/><link crossorigin=anonymous href=/assets/css/stylesheet.min.5e2b4101351c21e906f398ae96901791830f58d430f96f2659dab7eaef7b3cb7.css integrity="sha256-XitBATUcIekG85iulpAXkYMPWNQw+W8mWdq36u97PLc=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://appleshare.it/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://appleshare.it/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://appleshare.it/favicon-32x32.png><link rel=apple-touch-icon href=https://appleshare.it/apple-touch-icon.png><link rel=mask-icon href=https://appleshare.it/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.110.0"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="How to use dockutil in a script"><meta property="og:description" content="Now that dockutil has been rewritten in Swift for macOS 12.3 compatibility, I needed to dust off my scripts. dockutil is supporting macOS 11 Big Sur or higher.
Don&rsquo;t forget to look at the USAGE section in the readme or use the --help option to read more about the usage and options.
Luckily, not much is needed to be dusted off. However, I wanted to add some adjustments and share my workflows which you can use within Jamf."><meta property="og:type" content="article"><meta property="og:url" content="https://appleshare.it/posts/use-dockutil-in-a-script/"><meta property="og:image" content="https://appleshare.it/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-09T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-09T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://appleshare.it/papermod-cover.png"><meta name=twitter:title content="How to use dockutil in a script"><meta name=twitter:description content="Now that dockutil has been rewritten in Swift for macOS 12.3 compatibility, I needed to dust off my scripts. dockutil is supporting macOS 11 Big Sur or higher.
Don&rsquo;t forget to look at the USAGE section in the readme or use the --help option to read more about the usage and options.
Luckily, not much is needed to be dusted off. However, I wanted to add some adjustments and share my workflows which you can use within Jamf."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://appleshare.it/posts/"},{"@type":"ListItem","position":2,"name":"How to use dockutil in a script","item":"https://appleshare.it/posts/use-dockutil-in-a-script/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to use dockutil in a script","name":"How to use dockutil in a script","description":"Now that dockutil has been rewritten in Swift for macOS 12.3 compatibility, I needed to dust off my scripts. dockutil is supporting macOS 11 Big Sur or higher.\nDon\u0026rsquo;t forget to look at the USAGE section in the readme or use the --help option to read more about the usage and options.\nLuckily, not much is needed to be dusted off. However, I wanted to add some adjustments and share my workflows which you can use within Jamf.","keywords":["Dock","macOS","Script","Bash","workflows","Jamf Pro"],"articleBody":" Now that dockutil has been rewritten in Swift for macOS 12.3 compatibility, I needed to dust off my scripts. dockutil is supporting macOS 11 Big Sur or higher.\nDon’t forget to look at the USAGE section in the readme or use the --help option to read more about the usage and options.\nLuckily, not much is needed to be dusted off. However, I wanted to add some adjustments and share my workflows which you can use within Jamf. To support the older versions of macOS and dockutil, I kept my first setDock scripts and renamed this one to setDock-legacy this is for supporting before macOS 11.\nThere are many ways to manage the dock of an end-user. You can completely manage, semi manage or just add items to the dock. Whatever fits your needs, I prefer to leave the dock fully in control of the end-user so we just add items to the dock or create a basic dock to get the end-user started during enrollment\nWhat we need Download the scripts that is used and discussed in this blogpost from my GitHub repo. The latest release of dockutil (minimum version 3.0.0) the latest release can be found here on the GitHub repo. Clients must be macOS 11 Big Sur or higher (otherwise use older dockutil workflows) and for deploying to the devices we are using Jamf Pro. The script should be easy to use with other management systems.\nWe can deploy dockutil by uploading the dockutil installer PKG into the jamf Pro Server Settings -\u003e Computer Management -\u003e Packages\nAnother option is to use Installomator, but you need to add this label to the Installomator script if you are on version 9.0.1 or earlier. (It should be added in the next version.)\ndockutil) name=\"dockutil\" type=\"pkg\" packageID=\"dockutil.cli.tool\" downloadURL=$(downloadURLFromGit \"kcrawford\" \"dockutil\") appNewVersion=$(versionFromGit \"kcrawford\" \"dockutil\") expectedTeamID=\"Z5J8CJBUWC\" blockingProcesses=( NONE ) ;; Create a new policy, choose the preferred trigger, set the preferred frequency, add the dockutil.pkg or use the installomator script and don’t forget to scope to the Target Devices.\nBasics Now we have dockutil deployed we can start working on the scripts to set a default dock for your environment. Keep in mind, while testing you can easily reset the dock by deleting the current user’s com.apple.dock.plist file from the preferences.\nrunAsUser defaults delete com.apple.dock runAsUser killall cfprefsd killall Dock If we look at the usage of dockutil it’s straightforward. To add an application to the dock, just run this command\ndockutil --add /System/Applications/TextEdit.app This will add TextEdit to the end of the dock. This is a great example because I want to highlight something. If you look into your Applications folder, you will see the TextEdit application.\ndockutil doesn’t check if the application exists on the device, and will be added as a Question mark in the dock. To solve this you can create a function that will check if the application exists before he will run the command.\nThere are many options that you can use with dockutil, however, we are only using the options --add, --position, --no-restart and specify the path to the plist.\nThis is also the reason why I like dockutil, it is straightforward, I want to add x to the dock at this position, done!\nThe no-restart function is to prevent restarting the dock for each change. When you are not ready with the configuration, it makes no sense to restart the dock after every dockutil command.\nThe last important thing to know is if you run dockutil it runs in the userspace of that specific user. For example, if you run a script from Jamf you are creating a dock for the root user.\nMake sure that you run the script with the logged-in user.\nBuild your default dock Now we understand the basics for adding applications to the dock, let’s start building your organisation’s default dock.\nIf you look at the setDock-defaultDock.sh script from top to bottom, first we Collect important user information, have a function so we can run dockutil as currently logged in user, we check if dockutil is installed and version.\nBefore we set the dock we first empty it by running the following command:\nrunAsUser \"${dockutil}\" --remove all --no-restart I learned not to repeat code in code when you don’t need to. (trying to keep this in mind and yes I sometimes forget) To add the Applications to the dock, I’m using a loop to run the dockutil —add command.\nTherefore we need to make an Application path array from the apps we want to add to the default dock like below:\napps=( \"/Applications/Self Service.app\" \"/System/Applications/Launchpad.app\" \"/Applications/zoom.us.app\" \"/Applications/Google Chrome.app\" \"/Applications/.... etc.\" ) This array is used in the command we used in the loop\nrunAsUser \"${dockutil}\" --add \"$app\" --no-restart The array will start adding icons from the left side of the dock to the right. (top to bottom = left to right)\nIt doesn’t matter if you start with the files and folders or Applications but I like it to make a logical order.\nBefore adding the application to the dock we are verifying if the application is available on that given path: if [[ -e ${app} ]]\nBy doing this, we don’t end up with question marks as icons in the dock. (I know if you install the app later, this will be resolved. but i don’t like to confuse the end-user with a question mark)\nNow we have created the applications array, we can add a command to add “Files or Folders” (this can also include links to servers) to the dock. For adding “Files or Folders” we can configure how we want to present them, in the script we run the following command:\nrunAsUser \"${dockutil}\" --add ${userHome}/Downloads --view list --display stack --sort dateadded --no-restart With this command we add the Downloads folder to the dock with the icon displayed as a Stack, Content view as List and Sorted by Date Added. You can also add links to specific servers or even VNC connections to the dock by adding the smb://address or vnc://address with --label like the example below.\nrunAsUser \"${dockutil}\" --add [smb://fileserver.company.com](smb://fileserver.company.com) --label 'fileserver' --no-restart Optional: you can change other settings of the dock as well in this script for example “Disable show recent” by adding this command to the script:\nrunAsUser defaults write com.apple.dock show-recents -bool FALSE The last part we need to do to make sure the dock new configuration is loaded is to restart the dock by running this command: killall -KILL Dock\nNow you know how the script works, we can create a new policy, choose the preferred trigger, set the preferred frequency, add the setDock-defaultDock.sh to the policy and don’t forget to scope to the Target Devices.\nYou can add this policy into your enrollment workflow to have a default company dock when the device is enrolled.\nAnd thats basically it, by now you understand why I like dockutil ¯\\_(ツ)_/¯\nHow to use a dockutil script with variables in Jamf. I’m using dockutil over the build-in solution from the Jamf Pro Server, is because with dockutil we have more options. And to simplify this I created a script that can be re-used.\nUpload the setDock-addToDock.sh into you Jamf Pro Server Settings -\u003e Computer Management -\u003e Scripts make sure you fill in the Parameter Labels by options:\nParameter 4 = -- Required -- Application, Files or Folder Path ( /System/Applications/TextEdit.app ) Parameter 5 = Position ( index_number - beginning - end - middle ) Parameter 6 = View ( grid - fan - list - auto ) Parameter 7 = Display ( folder - stack ) Parameter 8 = Sort ( name - dateadded - datemodified - datecreated - kind ) This will help you to remember the options you can use while setting up the policy. The only required value is the Application, Files or Folder Path the rest is optional.\nCreate a new policy or add to an existing policy, go to the payload Scripts, add script setDock-addToDock.sh If you install the application you wan to add to the dock in the same policy, set Priority to After. Fill in the Parameter Values you want to add and set, and don’t forget to scope to the Target Devices.\nThats it! The script will check before adding the Application, Files or Folder to the dock we are verifying if the path is correct. You can go to the Policy -\u003e Logs to see the result of and what the error is if the policy didn’t work.\nHope you have a better understanding of how to use dockutil with a script to setup a default dock or to add a single item to the dock where ever you want.\nResources github.com/kcrawford/dockutil\ngithub.com/mvdbent/setDock\n","wordCount":"1449","inLanguage":"en","datePublished":"2022-03-09T00:00:00Z","dateModified":"2022-03-09T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://appleshare.it/posts/use-dockutil-in-a-script/"},"publisher":{"@type":"Organization","name":"AppleShare IT","logo":{"@type":"ImageObject","url":"https://appleshare.it/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://appleshare.it/ accesskey=h title="AppleShare IT (Alt + H)">AppleShare IT</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://appleshare.it/about/ title=About><span>About</span></a></li><li><a href=https://appleshare.it/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://appleshare.it/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://appleshare.it/links/ title=Links><span>Links</span></a></li><li><a href=https://appleshare.it/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>How to use dockutil in a script</h1><div class=post-meta>March 9, 2022&nbsp;·&nbsp;7 min</a></div></header><div class=post-content><figure class=align-center><a href=https://github.com/mvdbent/setDock target=_blank><img loading=lazy src=/img/dock.png#center height=300></a></figure><p><img loading=lazy src=https://img.shields.io/badge/macOS-11-success alt=GitHub>
<img loading=lazy src=https://img.shields.io/badge/macOS-12-success alt=GitHub></p><p>Now that <code>dockutil</code> has been rewritten in Swift for macOS 12.3 compatibility, I needed to dust off my scripts. <em>dockutil is supporting macOS 11 Big Sur or higher.</em></p><p>Don&rsquo;t forget to look at the <code>USAGE</code> section in the readme or use the <code>--help</code> option to read more about the usage and options.</p><p>Luckily, not much is needed to be dusted off. However, I wanted to add some adjustments and share my workflows which you can use within Jamf. To support the older versions of macOS and <code>dockutil</code>, I kept my first <code>setDock</code> scripts and renamed this one to <code>setDock-legacy</code> this is for supporting before macOS 11.</p><p>There are many ways to manage the dock of an end-user. You can completely manage, semi manage or just add items to the dock. Whatever fits your needs, I prefer to leave the dock fully in control of the end-user so we just add items to the dock or create a basic dock to get the end-user started during enrollment</p><h3 id=what-we-need>What we need<a hidden class=anchor aria-hidden=true href=#what-we-need>#</a></h3><p>Download the scripts that is used and discussed in this blogpost from my <a href=http://github.com/mvdbent/setDock>GitHub repo</a>.
The latest release of dockutil (minimum version 3.0.0) the latest release can be found here on the <a href=https://github.com/kcrawford/dockutil/releases>GitHub repo</a>. Clients must be macOS 11 Big Sur or higher (otherwise use older dockutil workflows) and for deploying to the devices we are using Jamf Pro. The script should be easy to use with other management systems.</p><p>We can deploy dockutil by uploading the dockutil installer PKG into the jamf Pro Server <code>Settings -> Computer Management -> Packages</code></p><p>Another option is to use <a href=http://github.com/Installomator/Installomator>Installomator</a>, but you need to add this label to the Installomator script if you are on version 9.0.1 or earlier. (It should be added in <a href=https://github.com/Installomator/Installomator/pull/432>the next version</a>.)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>	dockutil<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	  name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dockutil&#34;</span>
</span></span><span style=display:flex><span>	  type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pkg&#34;</span>
</span></span><span style=display:flex><span>	  packageID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dockutil.cli.tool&#34;</span>
</span></span><span style=display:flex><span>	  downloadURL<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>downloadURLFromGit <span style=color:#e6db74>&#34;kcrawford&#34;</span> <span style=color:#e6db74>&#34;dockutil&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>	  appNewVersion<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>versionFromGit <span style=color:#e6db74>&#34;kcrawford&#34;</span> <span style=color:#e6db74>&#34;dockutil&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>	  expectedTeamID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Z5J8CJBUWC&#34;</span>
</span></span><span style=display:flex><span>	  blockingProcesses<span style=color:#f92672>=(</span> NONE <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	  ;;
</span></span></code></pre></div><p>Create a new policy, choose the preferred trigger, set the preferred frequency, add the dockutil.pkg or use the installomator script and don’t forget to scope to the Target Devices.</p><h3 id=basics>Basics<a hidden class=anchor aria-hidden=true href=#basics>#</a></h3><p>Now we have dockutil deployed we can start working on the scripts to set a default dock for your environment. Keep in mind, while testing you can easily reset the dock by deleting the current user&rsquo;s com.apple.dock.plist file from the preferences.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>	runAsUser defaults delete com.apple.dock
</span></span><span style=display:flex><span>	runAsUser killall cfprefsd
</span></span><span style=display:flex><span>	killall Dock
</span></span></code></pre></div><p>If we look at the usage of dockutil it’s straightforward. To add an application to the dock, just run this command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>	dockutil --add /System/Applications/TextEdit.app
</span></span></code></pre></div><p>This will add TextEdit to the end of the dock. This is a great example because I want to highlight something. If you look into your Applications folder, you will see the TextEdit application.</p><p>dockutil doesn’t check if the application exists on the device, and will be added as a Question mark in the dock.<figure class=align-center><img loading=lazy src=/img/DockScreenshot.png#center></figure></p><p>To solve this you can create a function that will check if the application exists before he will run the command.</p><p>There are many options that you can use with dockutil, however, we are only using the options <code>--add</code>, <code>--position</code>, <code>--no-restart</code> and specify the path to the plist.</p><p style=color:#3fc69b>This is also the reason why I like dockutil, it is straightforward, I want to add x to the dock at this position, done!</p><p>The no-restart function is to prevent restarting the dock for each change. When you are not ready with the configuration, it makes no sense to restart the dock after every dockutil command.</p><p>The last important thing to know is if you run dockutil it runs in the userspace of that specific user. For example, if you run a script from Jamf you are creating a dock for the root user.</p><p>Make sure that you <a href=http://scriptingosx.com/2020/08/running-a-command-as-another-user/>run the script with the logged-in user</a>.</p><h3 id=build-your-default-dock>Build your default dock<a hidden class=anchor aria-hidden=true href=#build-your-default-dock>#</a></h3><p>Now we understand the basics for adding applications to the dock, let’s start building your organisation’s default dock.</p><p>If you look at the <code>setDock-defaultDock.sh</code> script from top to bottom, first we <code>Collect important user information</code>, have a function so we can run <code>dockutil</code> as currently logged in user, we check if <code>dockutil</code> is installed and version.</p><p>Before we set the dock we first empty it by running the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>	runAsUser <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>dockutil<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> --remove all --no-restart
</span></span></code></pre></div><p>I learned not to repeat code in code when you don’t need to. (trying to keep this in mind and yes I sometimes forget) To add the Applications to the dock, I’m using a loop to run the <code>dockutil —add</code> command.</p><p>Therefore we need to make an Application path array from the apps we want to add to the default dock like below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>	apps<span style=color:#f92672>=(</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;/Applications/Self Service.app&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;/System/Applications/Launchpad.app&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;/Applications/zoom.us.app&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;/Applications/Google Chrome.app&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;/Applications/.... etc.&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>This array is used in the command we used in the loop</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>	runAsUser <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>dockutil<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> --add <span style=color:#e6db74>&#34;</span>$app<span style=color:#e6db74>&#34;</span> --no-restart
</span></span></code></pre></div><p>The array will start adding icons from the left side of the dock to the right. (top to bottom = left to right)</p><p>It doesn&rsquo;t matter if you start with the files and folders or Applications but I like it to make a logical order.</p><p>Before adding the application to the dock we are verifying if the application is available on that given path: <code>if [[ -e ${app} ]]</code></p><p>By doing this, we don’t end up with question marks as icons in the dock. (I know if you install the app later, this will be resolved. but i don’t like to confuse the end-user with a question mark)</p><p>Now we have created the applications array, we can add a command to add “Files or Folders” (this can also include links to servers) to the dock. For adding “Files or Folders” we can configure how we want to present them, in the script we run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>	runAsUser <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>dockutil<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> --add <span style=color:#e6db74>${</span>userHome<span style=color:#e6db74>}</span>/Downloads --view list --display stack --sort dateadded --no-restart
</span></span></code></pre></div><p>With this command we add the <code>Downloads</code> folder to the dock with the icon displayed as a <code>Stack</code>, Content view as <code>List</code> and Sorted by <code>Date Added</code>. You can also add links to specific servers or even VNC connections to the dock by adding the <code>smb://address</code> or <code>vnc://address</code> with <code>--label</code> like the example below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>	runAsUser <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>dockutil<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> --add <span style=color:#f92672>[</span>smb://fileserver.company.com<span style=color:#f92672>](</span>smb://fileserver.company.com<span style=color:#f92672>)</span> --label <span style=color:#e6db74>&#39;fileserver&#39;</span> --no-restart
</span></span></code></pre></div><p>Optional: you can change other settings of the dock as well in this script for example &ldquo;Disable show recent&rdquo; by adding this command to the script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>	runAsUser defaults write com.apple.dock show-recents -bool FALSE
</span></span></code></pre></div><p>The last part we need to do to make sure the dock new configuration is loaded is to restart the dock by running this command: <code>killall -KILL Dock</code></p><p>Now you know how the script works, we can create a new policy, choose the preferred trigger, set the preferred frequency, add the <code>setDock-defaultDock.sh</code> to the policy and don’t forget to scope to the Target Devices.</p><p>You can add this policy into your enrollment workflow to have a default company dock when the device is enrolled.</p><figure class=align-center><img loading=lazy src=/img/defaultDock.png#center></figure><p>And thats basically it, by now you understand why I like <code>dockutil</code> ¯\_(ツ)_/¯</p><h2 id=how-to-use-a-dockutil-script-with-variables-in-jamf>How to use a dockutil script with variables in Jamf.<a hidden class=anchor aria-hidden=true href=#how-to-use-a-dockutil-script-with-variables-in-jamf>#</a></h2><p>I’m using <code>dockutil</code> over the build-in solution from the Jamf Pro Server, is because with <code>dockutil</code> we have more options. And to simplify this I created a script that can be re-used.</p><p>Upload the <code>setDock-addToDock.sh</code> into you Jamf Pro Server <code>Settings -> Computer Management -> Scripts</code> make sure you fill in the <code>Parameter Labels</code> by options:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>	Parameter 4 <span style=color:#f92672>=</span> -- Required -- Application, Files or Folder Path <span style=color:#f92672>(</span> /System/Applications/TextEdit.app <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	Parameter 5 <span style=color:#f92672>=</span> Position <span style=color:#f92672>(</span> index_number - beginning - end - middle <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	Parameter 6 <span style=color:#f92672>=</span> View <span style=color:#f92672>(</span> grid - fan - list - auto <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	Parameter 7 <span style=color:#f92672>=</span> Display <span style=color:#f92672>(</span> folder - stack <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	Parameter 8 <span style=color:#f92672>=</span> Sort <span style=color:#f92672>(</span> name - dateadded - datemodified - datecreated - kind <span style=color:#f92672>)</span>
</span></span></code></pre></div><p>This will help you to remember the options you can use while setting up the policy. The only required value is the <code>Application, Files or Folder Path</code> the rest is optional.</p><p>Create a new policy or add to an existing policy, go to the payload Scripts, add script <code>setDock-addToDock.sh</code> If you install the application you wan to add to the dock in the same policy, set <code>Priority</code> to <code>After</code>. Fill in the Parameter Values you want to add and set, and don’t forget to scope to the Target Devices.</p><figure class=align-center><img loading=lazy src=/img/addToDock.png#center></figure><h2 style=color:#3fc69b>Thats it!</h2><p>The script will check before adding the Application, Files or Folder to the dock we are verifying if the path is correct. You can go to the <code>Policy -> Logs</code> to see the result of and what the error is if the policy didn&rsquo;t work.</p><p>Hope you have a better understanding of how to use <code>dockutil</code> with a script to setup a default dock or to add a single item to the dock where ever you want.</p><h3 id=resources>Resources<a hidden class=anchor aria-hidden=true href=#resources>#</a></h3><ul><li><p><a href=http://github.com/kcrawford/dockutil>github.com/kcrawford/dockutil</a></p></li><li><p><a href=http://github.com/mvdbent/setDock>github.com/mvdbent/setDock</a></p></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://appleshare.it/tags/dock/>Dock</a></li><li><a href=https://appleshare.it/tags/macos/>macOS</a></li><li><a href=https://appleshare.it/tags/script/>Script</a></li><li><a href=https://appleshare.it/tags/bash/>Bash</a></li><li><a href=https://appleshare.it/tags/workflows/>workflows</a></li><li><a href=https://appleshare.it/tags/jamf-pro/>Jamf Pro</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://appleshare.it/>AppleShare IT</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>