<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>CIS Custom Rules Set mSCP | AppleShare IT</title>
<meta name=keywords content="CIS,Benchmark,Documnetation,macOS,Security">
<meta name=description content="While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.
While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.">
<meta name=author content>
<link rel=canonical href=https://appleshare.it/posts/cis-custom-rules-set-mscp/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.5e2b4101351c21e906f398ae96901791830f58d430f96f2659dab7eaef7b3cb7.css integrity="sha256-XitBATUcIekG85iulpAXkYMPWNQw+W8mWdq36u97PLc=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://appleshare.it/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://appleshare.it/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://appleshare.it/favicon-32x32.png>
<link rel=apple-touch-icon href=https://appleshare.it/apple-touch-icon.png>
<link rel=mask-icon href=https://appleshare.it/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.88.1">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript><meta property="og:title" content="CIS Custom Rules Set mSCP">
<meta property="og:description" content="While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.
While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://appleshare.it/posts/cis-custom-rules-set-mscp/"><meta property="og:image" content="https://appleshare.it/papermod-cover.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-09-03T00:00:00+00:00">
<meta property="article:modified_time" content="2021-09-03T00:00:00+00:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://appleshare.it/papermod-cover.png">
<meta name=twitter:title content="CIS Custom Rules Set mSCP">
<meta name=twitter:description content="While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.
While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://appleshare.it/posts/"},{"@type":"ListItem","position":2,"name":"CIS Custom Rules Set mSCP","item":"https://appleshare.it/posts/cis-custom-rules-set-mscp/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CIS Custom Rules Set mSCP","name":"CIS Custom Rules Set mSCP","description":"While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.\nWhile working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.","keywords":["CIS","Benchmark","Documnetation","macOS","Security"],"articleBody":"  While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.\nWhile working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.\nSo I started to transform the CIS Benchmark PDF from Big Sur into custom rules set to integrate with the macOS Security Compliance Project. You can find the mSCP here and the CIS Benchmark custom rules set here github.com/mvdbent/CIS-macOS-Security\nUsage/Requirements The CIS Benchmark rules are tested on macOS Big Sur 11. and the latest macOS Security Compliance Project release.*\n Download the CIS-macOS-Security to your device. Download the macOS Security Compliance Project to your device. Install the Prerequisites for the macOS Security Compliance Project, see instuctions here Copy the CIS-macOS-Security /custom/ folder into the macOS Security Compliance Project and overwrite the empty /custom/ folder.  The /custom/ folder in the macOS Security Compliance Project is in the .gitignore file so you can safely update to the latest version of macOS Security Compliance Project without loosing the CIS Benchmark baselines.\nGenerate a Baseline The project provides the following baseline files, located in the /custom/baselines/ folder:\n CIS-Benchmark.yaml CIS-Benchmark-L1.yaml CIS-Benchmark-L2.yaml  If you want to create your own baseline or modify an existing baseline, the generate-baseline.py found in the scripts folder will generate a {baseline}.yaml file containing all the rules corresponding with the provided tag (baseline). This {baseline}.yaml is required to run the generate-guidance.py script.\nGet a list of available tags and you will see the CIS-Benchmark tags as well\n$ macOS-Security git:(master) ./scripts/generate_baseline.py -l  800-171 800-53r4_high 800-53r4_low 800-53r4_moderate CIS-Benchmark CIS-Benchmark-L1 CIS-Benchmark-L2 cnssi-1253 inherent manual n_a none permanent stig supplemental  Generate a new baseline\n$ macOS-Security git:(master) ./scripts/generate_baseline.py -k CIS-Benchmark-L1 $ macOS-Security git:(master) ls -dn build/baselines/* -rw-r--r-- 1 501 20 6350 May 10 13:30 build/baselines/CIS-Benchmark-L1.yaml The generated baseline will be saved into the build/baselines/\nGenerate CIS Benchmark guidance To generate the guidance files (AsciiDoc, HTML, PDF, Excel, mobileconfigs, and compliance script) run the generate-guidance.py script and point it to either one of the built-in baseline.yaml files or a custom CIS Benchmark baseline.yaml file in the custom/baselines folder or created by the generate-baseline.py script.\nAsciiDoc, HTML, and PDF\n$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml **AsciiDoc, HTML, and PDF with custom logo **\n$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -l /Git/macOS-Security/custom/Images/cis_banner.png AsciiDoc, HTML, PDF, and Excel\n$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -x AsciiDoc, HTML, PDF, Excel, and mobileconfigs\n$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -x -p AsciiDoc, HTML, PDF, Excel, mobileconfigs, and custom logo use full-path to custom logo\n$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -l /Git/macOS-Security/custom/Images/cis_banner.png -p -x Hope this will help you building your custom documentation based on CIS Benchmark “Big Sur”\nResources github.com/mvdbent/CIS-Reporting\n","wordCount":"482","inLanguage":"en","datePublished":"2021-09-03T00:00:00Z","dateModified":"2021-09-03T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://appleshare.it/posts/cis-custom-rules-set-mscp/"},"publisher":{"@type":"Organization","name":"AppleShare IT","logo":{"@type":"ImageObject","url":"https://appleshare.it/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://appleshare.it/ accesskey=h title="AppleShare IT (Alt + H)">AppleShare IT</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://appleshare.it/about title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://appleshare.it/archives/ title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://appleshare.it/posts/ title=Blog>
<span>Blog</span>
</a>
</li>
<li>
<a href=https://appleshare.it/links title=Links>
<span>Links</span>
</a>
</li>
<li>
<a href=https://appleshare.it/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
CIS Custom Rules Set mSCP
</h1>
<div class=post-meta>September 3, 2021&nbsp;·&nbsp;3 min</a>
</div>
</header>
<div class=post-content><figure class=align-center><a href=https://github.com/mvdbent/CIS-Reporting>
<img loading=lazy src="https://github.com/mvdbent/CIS-macOS-Security/blob/main/custom/Images/CIS-macOS-Security.png?raw=true#center" height=300> </a>
</figure>
<p><img loading=lazy src=https://img.shields.io/badge/macOS-11-success alt=GitHub>
</p>
<p>While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.</p>
<p>While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.</p>
<p>So I started to transform the CIS Benchmark PDF from Big Sur into custom rules set to integrate with the macOS Security Compliance Project. You can find the mSCP <a href=https://github.com/usnistgov/macos_security>here</a> and the CIS Benchmark custom rules set here <a href=https://github.com/mvdbent/CIS-macOS-Security>github.com/mvdbent/CIS-macOS-Security</a></p>
<h2 id=usagerequirements>Usage/Requirements<a hidden class=anchor aria-hidden=true href=#usagerequirements>#</a></h2>
<p><em>The CIS Benchmark rules are tested on macOS Big Sur 11.</em> and the latest macOS Security Compliance Project release.*</p>
<ol>
<li>Download the <strong>CIS-macOS-Security</strong> to your device.</li>
<li>Download the <strong>macOS Security Compliance Project</strong> to your device.</li>
<li>Install the Prerequisites for the <strong>macOS Security Compliance Project</strong>, see instuctions <a href=https://github.com/usnistgov/macos_security/wiki/Getting-Started>here</a></li>
<li>Copy the <strong>CIS-macOS-Security</strong> <code>/custom/</code> folder into the <strong>macOS Security Compliance Project</strong> and overwrite the empty <code>/custom/</code> folder.</li>
</ol>
<p>The <code>/custom/</code> folder in the <strong>macOS Security Compliance Project</strong> is in the .gitignore file so you can safely update to the latest version of <strong>macOS Security Compliance Project</strong> without loosing the <strong>CIS Benchmark baselines</strong>.</p>
<h3 id=generate-a-baseline>Generate a Baseline<a hidden class=anchor aria-hidden=true href=#generate-a-baseline>#</a></h3>
<p>The project provides the following baseline files, located in the <code>/custom/baselines/</code> folder:</p>
<ul>
<li>CIS-Benchmark.yaml</li>
<li>CIS-Benchmark-L1.yaml</li>
<li>CIS-Benchmark-L2.yaml</li>
</ul>
<p>If you want to create your own baseline or modify an existing baseline, the <code>generate-baseline.py</code> found in the scripts folder will generate a <code>{baseline}.yaml</code> file containing all the rules corresponding with the provided tag (baseline). This <code>{baseline}.yaml</code> is required to run the <code>generate-guidance.py</code> script.</p>
<p>Get a list of available tags and you will see the CIS-Benchmark tags as well</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ macOS-Security git:<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> ./scripts/generate_baseline.py -l
</code></pre></div><ul>
<li>800-171</li>
<li>800-53r4_high</li>
<li>800-53r4_low</li>
<li>800-53r4_moderate</li>
<li><strong>CIS-Benchmark</strong></li>
<li><strong>CIS-Benchmark-L1</strong></li>
<li><strong>CIS-Benchmark-L2</strong></li>
<li>cnssi-1253</li>
<li>inherent</li>
<li>manual</li>
<li>n_a</li>
<li>none</li>
<li>permanent</li>
<li>stig</li>
<li>supplemental</li>
</ul>
<p><strong>Generate a new baseline</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ macOS-Security git:<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> ./scripts/generate_baseline.py -k CIS-Benchmark-L1
$ macOS-Security git:<span style=color:#f92672>(</span>master<span style=color:#f92672>)</span> ls -dn build/baselines/*
-rw-r--r--  <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>501</span>  <span style=color:#ae81ff>20</span>  <span style=color:#ae81ff>6350</span> May <span style=color:#ae81ff>10</span> 13:30 build/baselines/CIS-Benchmark-L1.yaml
</code></pre></div><p>The generated baseline will be saved into the <code>build/baselines/</code></p>
<h3 id=generate-cis-benchmark-guidance>Generate CIS Benchmark guidance<a hidden class=anchor aria-hidden=true href=#generate-cis-benchmark-guidance>#</a></h3>
<p>To generate the guidance files (AsciiDoc, HTML, PDF, Excel, mobileconfigs, and compliance script) run the <code>generate-guidance.py</code> script and point it to either one of the built-in <code>baseline.yaml</code> files or a custom CIS Benchmark baseline.yaml file in the <code>custom/baselines</code> folder or created by the <code>generate-baseline.py</code> script.</p>
<p><strong>AsciiDoc, HTML, and PDF</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml
</code></pre></div><p>**AsciiDoc, HTML, and PDF with custom logo **</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -l /Git/macOS-Security/custom/Images/cis_banner.png
</code></pre></div><p><strong>AsciiDoc, HTML, PDF, and Excel</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -x
</code></pre></div><p><strong>AsciiDoc, HTML, PDF, Excel, and mobileconfigs</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -x -p
</code></pre></div><p><strong>AsciiDoc, HTML, PDF, Excel, mobileconfigs, and custom logo</strong>
<em>use full-path to custom logo</em></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -l /Git/macOS-Security/custom/Images/cis_banner.png -p -x
</code></pre></div><p>Hope this will help you building your custom documentation based on CIS Benchmark &ldquo;Big Sur&rdquo;</p>
<h3 id=resources>Resources<a hidden class=anchor aria-hidden=true href=#resources>#</a></h3>
<p><a href=https://github.com/mvdbent/CIS-Reporting><strong>github.com/mvdbent/CIS-Reporting</strong></a></p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://appleshare.it/tags/cis/>CIS</a></li>
<li><a href=https://appleshare.it/tags/benchmark/>Benchmark</a></li>
<li><a href=https://appleshare.it/tags/documnetation/>Documnetation</a></li>
<li><a href=https://appleshare.it/tags/macos/>macOS</a></li>
<li><a href=https://appleshare.it/tags/security/>Security</a></li>
</ul>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://appleshare.it/>AppleShare IT</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>