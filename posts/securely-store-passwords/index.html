<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Securely Store Passwords | AppleShare IT</title>
<meta name=keywords content="Security,macOS,Script,Bash">
<meta name=description content="Securely store Passwords into the macOS Keychain Why put cleartext passwords in scripts, when we can use the macOS Keychain to securely store this information for us.
How to have a easy way to include this into your scripts, so we can have a placeholder for the password rather then leaking this password within the script.
How to We are going to add an PASSWORD into the macOS Keychain with the security command.">
<meta name=author content>
<link rel=canonical href=https://appleshare.it/posts/securely-store-passwords/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.5e2b4101351c21e906f398ae96901791830f58d430f96f2659dab7eaef7b3cb7.css integrity="sha256-XitBATUcIekG85iulpAXkYMPWNQw+W8mWdq36u97PLc=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://appleshare.it/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://appleshare.it/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://appleshare.it/favicon-32x32.png>
<link rel=apple-touch-icon href=https://appleshare.it/apple-touch-icon.png>
<link rel=mask-icon href=https://appleshare.it/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.88.1">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript><meta property="og:title" content="Securely Store Passwords">
<meta property="og:description" content="Securely store Passwords into the macOS Keychain Why put cleartext passwords in scripts, when we can use the macOS Keychain to securely store this information for us.
How to have a easy way to include this into your scripts, so we can have a placeholder for the password rather then leaking this password within the script.
How to We are going to add an PASSWORD into the macOS Keychain with the security command.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://appleshare.it/posts/securely-store-passwords/"><meta property="og:image" content="https://appleshare.it/papermod-cover.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-09-04T00:00:00+00:00">
<meta property="article:modified_time" content="2020-09-04T00:00:00+00:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://appleshare.it/papermod-cover.png">
<meta name=twitter:title content="Securely Store Passwords">
<meta name=twitter:description content="Securely store Passwords into the macOS Keychain Why put cleartext passwords in scripts, when we can use the macOS Keychain to securely store this information for us.
How to have a easy way to include this into your scripts, so we can have a placeholder for the password rather then leaking this password within the script.
How to We are going to add an PASSWORD into the macOS Keychain with the security command.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://appleshare.it/posts/"},{"@type":"ListItem","position":2,"name":"Securely Store Passwords","item":"https://appleshare.it/posts/securely-store-passwords/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Securely Store Passwords","name":"Securely Store Passwords","description":"Securely store Passwords into the macOS Keychain Why put cleartext passwords in scripts, when we can use the macOS Keychain to securely store this information for us.\nHow to have a easy way to include this into your scripts, so we can have a placeholder for the password rather then leaking this password within the script.\nHow to We are going to add an PASSWORD into the macOS Keychain with the security command.","keywords":["Security","macOS","Script","Bash"],"articleBody":"Securely store Passwords into the macOS Keychain Why put cleartext passwords in scripts, when we can use the macOS Keychain to securely store this information for us.\nHow to have a easy way to include this into your scripts, so we can have a placeholder for the password rather then leaking this password within the script.\nHow to We are going to add an PASSWORD into the macOS Keychain with the security command. For this command we are using -T to add an entry to the login keychain and add the security binary to “Always allow access by these applications:” list in the Access Control preferences.\nsecurity add-generic-password [-s service] [-a account] [-w password] -T [appPath] Usage: -s service Specify service name (required) -a account Specify account name (required) -w password Specify password to be added. Put at end of command to be prompted (recommended) -T appPath Specify an application which may access this item (multiple -T options are allowed) Example:\nsecurity add-generic-password -s `SERVICE-NAME` -a `ACCOUNT-NAME` -w `PASSWORD` -T /usr/bin/security Now we securely store the PASSWORD into the macOS Keychain, and allowing the security binary to access this entry. We can use the security command to fetch the PASSWORD.\nsecurity find-generic-password [-s service] -w Usage: -s service Match service string -w Display the password(only) for the item found We only need to provide the service name and ask for the password\nExample:\nsecurity find-generic-password -s `SERVICE-NAME` -w #RESULT `PASSWORD` Now we can include this placeholder into the scripts, and fetch the PASSWORD in a secure way.\n# Variables serviceName=SERVICE-NAME password=$(security find-generic-password -s ${serviceName} -w) See the man page security in terminal for more options. man security\n","wordCount":"277","inLanguage":"en","datePublished":"2020-09-04T00:00:00Z","dateModified":"2020-09-04T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://appleshare.it/posts/securely-store-passwords/"},"publisher":{"@type":"Organization","name":"AppleShare IT","logo":{"@type":"ImageObject","url":"https://appleshare.it/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://appleshare.it/ accesskey=h title="AppleShare IT (Alt + H)">AppleShare IT</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://appleshare.it/about title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://appleshare.it/archives title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://appleshare.it/posts title=Blog>
<span>Blog</span>
</a>
</li>
<li>
<a href=https://appleshare.it/links/ title=Links>
<span>Links</span>
</a>
</li>
<li>
<a href=https://appleshare.it/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Securely Store Passwords
</h1>
<div class=post-meta>September 4, 2020&nbsp;·&nbsp;2 min</a>
</div>
</header>
<div class=post-content><h2 id=securely-store-passwords-into-the-macos-keychain>Securely store Passwords into the macOS Keychain<a hidden class=anchor aria-hidden=true href=#securely-store-passwords-into-the-macos-keychain>#</a></h2>
<p>Why put cleartext passwords in scripts, when we can use the macOS Keychain to securely store this information for us.</p>
<p>How to have a easy way to include this into your scripts, so we can have a placeholder for the password rather then leaking this password within the script.</p>
<h3 id=how-to>How to<a hidden class=anchor aria-hidden=true href=#how-to>#</a></h3>
<p>We are going to add an <code>PASSWORD</code> into the macOS Keychain with the <code>security</code> command.
For this command we are using <code>-T</code> to add an entry to the login keychain and add the <code>security</code> binary to &ldquo;Always allow access by these applications:&rdquo; list in the Access Control preferences.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>security add-generic-password <span style=color:#f92672>[</span>-s service<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-a account<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-w password<span style=color:#f92672>]</span> -T <span style=color:#f92672>[</span>appPath<span style=color:#f92672>]</span>

Usage: 
-s service      Specify service name <span style=color:#f92672>(</span>required<span style=color:#f92672>)</span>
-a account      Specify account name <span style=color:#f92672>(</span>required<span style=color:#f92672>)</span>
-w password     Specify password to be added. Put at end of command to be prompted <span style=color:#f92672>(</span>recommended<span style=color:#f92672>)</span>
-T appPath      Specify an application which may access this item <span style=color:#f92672>(</span>multiple -T options are allowed<span style=color:#f92672>)</span>
</code></pre></div><p><em>Example:</em></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>security add-generic-password -s <span style=color:#e6db74>`</span>SERVICE-NAME<span style=color:#e6db74>`</span> -a <span style=color:#e6db74>`</span>ACCOUNT-NAME<span style=color:#e6db74>`</span> -w <span style=color:#e6db74>`</span>PASSWORD<span style=color:#e6db74>`</span> -T /usr/bin/security
</code></pre></div><p>Now we securely store the <code>PASSWORD</code> into the macOS Keychain, and allowing the <code>security</code> binary to access this entry.
We can use the <code>security</code> command to fetch the <code>PASSWORD</code>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>security find-generic-password <span style=color:#f92672>[</span>-s service<span style=color:#f92672>]</span> -w 
Usage:
-s service      Match service string
-w              Display the password<span style=color:#f92672>(</span>only<span style=color:#f92672>)</span> <span style=color:#66d9ef>for</span> the item found
</code></pre></div><p>We only need to provide the service name and ask for the password</p>
<p><em>Example:</em></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>security find-generic-password -s <span style=color:#e6db74>`</span>SERVICE-NAME<span style=color:#e6db74>`</span> -w
<span style=color:#75715e>#RESULT</span>
<span style=color:#e6db74>`</span>PASSWORD<span style=color:#e6db74>`</span>
</code></pre></div><p>Now we can include this placeholder into the scripts, and fetch the <code>PASSWORD</code> in a secure way.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Variables</span>
serviceName<span style=color:#f92672>=</span>SERVICE-NAME
password<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>security find-generic-password -s <span style=color:#e6db74>${</span>serviceName<span style=color:#e6db74>}</span> -w<span style=color:#66d9ef>)</span>
</code></pre></div><p>See the man page security in terminal for more options. <code>man security</code></p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://appleshare.it/tags/security/>Security</a></li>
<li><a href=https://appleshare.it/tags/macos/>macOS</a></li>
<li><a href=https://appleshare.it/tags/script/>Script</a></li>
<li><a href=https://appleshare.it/tags/bash/>Bash</a></li>
</ul>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://appleshare.it/>AppleShare IT</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>