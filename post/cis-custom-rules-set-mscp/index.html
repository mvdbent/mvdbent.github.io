<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        CIS Custom Rules Set mSCP ::
        AppleShare IT — Blog about Apple IT related matters
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="github.com/mvdbent/CIS-Reporting
While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.
So I started to transform the CIS Benchmark PDF from Big Sur into custom rules set to integrate with the macOS Security Compliance Project. You can find the mSCP here and the CIS Benchmark custom rules set here github."
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="/post/cis-custom-rules-set-mscp/" />





<link rel="stylesheet" href="/assets/style.css" />

<link rel="stylesheet" href="/style.css" />


<link
  rel="apple-touch-icon-precomposed"
  sizes="144x144"
  href="/img/apple-touch-icon-144-precomposed.png"
/>
<link rel="shortcut icon" href="/img/favicon.png" />


<link href="/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CIS Custom Rules Set mSCP"/>
<meta name="twitter:description" content="While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script."/>



<meta property="og:title" content="CIS Custom Rules Set mSCP" />
<meta property="og:description" content="While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/cis-custom-rules-set-mscp/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-09-03T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-09-03T00:00:00+00:00" /><meta property="og:site_name" content="AppleShare IT" />







  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >AppleShare IT</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/archive">Archive</a></li>
        
      
        
          <li><a href="/post">Blog</a></li>
        
      
        
          <li><a href="/links">Links</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/archive">Archive</a></li>
      
    
      
        <li><a href="/post">Blog</a></li>
      
    
      
        <li><a href="/links">Links</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">CIS Custom Rules Set mSCP</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2021-09-03
        </span>

        
          
        
      

      


      
        <span class="post-read-time"
          >— 3 min read</span
        >
      
    </div>

    
      <span class="post-tags">
        
          <a href="/tags/cis/">#CIS</a>&nbsp;
        
          <a href="/tags/benchmark/">#Benchmark</a>&nbsp;
        
          <a href="/tags/documnetation/">#Documnetation</a>&nbsp;
        
          <a href="/tags/macos/">#macOS</a>&nbsp;
        
          <a href="/tags/security/">#Security</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      
      
  <img src="https://github.com/mvdbent/CIS-macOS-Security/blob/main/custom/Images/CIS-macOS-Security.png?raw=true"  class="left"  style="border-radius: 8px; height: 300px;"  />


<p><a href="https://github.com/mvdbent/CIS-Reporting"><strong>github.com/mvdbent/CIS-Reporting</strong></a></p>
<p><img src="https://img.shields.io/badge/macOS-11-success" alt="GitHub"></p>
<p>While working with CIS Benchmarks PDF (guidelines for scripts and/or Configuration Profiles) I felt there must be a better and faster way. The guys from the macOS Security Compliance Project did an amazing job automating the guidance, needed scripts, configuration profiles, and remediation script.</p>
<p>So I started to transform the CIS Benchmark PDF from Big Sur into custom rules set to integrate with the macOS Security Compliance Project. You can find the mSCP <a href="https://github.com/usnistgov/macos_security">here</a> and the CIS Benchmark custom rules set here <a href="https://github.com/mvdbent/CIS-macOS-Security"><strong>github.com/mvdbent/CIS-macOS-Security</strong></a></p>
<h2 id="usagerequirements">Usage/Requirements</h2>
<p><em>The CIS Benchmark rules are tested on macOS Big Sur 11.</em> and the latest macOS Security Compliance Project release.*</p>
<ol>
<li>Download the <strong>CIS-macOS-Security</strong> to your device.</li>
<li>Download the <strong>macOS Security Compliance Project</strong> to your device.</li>
<li>Install the Prerequisites for the <strong>macOS Security Compliance Project</strong>, see instuctions <a href="https://github.com/usnistgov/macos_security/wiki/Getting-Started">here</a></li>
<li>Copy the <strong>CIS-macOS-Security</strong> <code>/custom/</code> folder into the <strong>macOS Security Compliance Project</strong> and overwrite the empty <code>/custom/</code> folder.</li>
</ol>
<p>The <code>/custom/</code> folder in the <strong>macOS Security Compliance Project</strong> is in the .gitignore file so you can safely update to the latest version of <strong>macOS Security Compliance Project</strong> without loosing the <strong>CIS Benchmark baselines</strong>.</p>
<h3 id="generate-a-baseline">Generate a Baseline</h3>
<p>The project provides the following baseline files, located in the <code>/custom/baselines/</code> folder:</p>
<ul>
<li>CIS-Benchmark.yaml</li>
<li>CIS-Benchmark-L1.yaml</li>
<li>CIS-Benchmark-L2.yaml</li>
</ul>
<p>If you want to create your own baseline or modify an existing baseline, the <code>generate-baseline.py</code> found in the scripts folder will generate a <code>{baseline}.yaml</code> file containing all the rules corresponding with the provided tag (baseline). This <code>{baseline}.yaml</code> is required to run the <code>generate-guidance.py</code> script.</p>
<p>Get a list of available tags and you will see the CIS-Benchmark tags as well</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ macOS-Security git:<span style="color:#f92672">(</span>master<span style="color:#f92672">)</span> ./scripts/generate_baseline.py -l
</code></pre></div><ul>
<li>800-171</li>
<li>800-53r4_high</li>
<li>800-53r4_low</li>
<li>800-53r4_moderate</li>
<li><strong>CIS-Benchmark</strong></li>
<li><strong>CIS-Benchmark-L1</strong></li>
<li><strong>CIS-Benchmark-L2</strong></li>
<li>cnssi-1253</li>
<li>inherent</li>
<li>manual</li>
<li>n_a</li>
<li>none</li>
<li>permanent</li>
<li>stig</li>
<li>supplemental</li>
</ul>
<p><strong>Generate a new baseline</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ macOS-Security git:<span style="color:#f92672">(</span>master<span style="color:#f92672">)</span> ./scripts/generate_baseline.py -k CIS-Benchmark-L1
$ macOS-Security git:<span style="color:#f92672">(</span>master<span style="color:#f92672">)</span> ls -dn build/baselines/*
-rw-r--r--  <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">501</span>  <span style="color:#ae81ff">20</span>  <span style="color:#ae81ff">6350</span> May <span style="color:#ae81ff">10</span> 13:30 build/baselines/CIS-Benchmark-L1.yaml
</code></pre></div><p>The generated baseline will be saved into the <code>build/baselines/</code></p>
<h3 id="generate-cis-benchmark-guidance">Generate CIS Benchmark guidance</h3>
<p>To generate the guidance files (AsciiDoc, HTML, PDF, Excel, mobileconfigs, and compliance script) run the <code>generate-guidance.py</code> script and point it to either one of the built-in <code>baseline.yaml</code> files or a custom CIS Benchmark baseline.yaml file in the <code>custom/baselines</code> folder or created by the <code>generate-baseline.py</code> script.</p>
<p><strong>AsciiDoc, HTML, and PDF</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml
</code></pre></div><p>**AsciiDoc, HTML, and PDF with custom logo **</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -l /Git/macOS-Security/custom/Images/cis_banner.png
</code></pre></div><p><strong>AsciiDoc, HTML, PDF, and Excel</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -x
</code></pre></div><p><strong>AsciiDoc, HTML, PDF, Excel, and mobileconfigs</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -x -p
</code></pre></div><p><strong>AsciiDoc, HTML, PDF, Excel, mobileconfigs, and custom logo</strong>
<em>use full-path to custom logo</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ./scripts/generate_guidance.py custom/baselines/CIS-Benchmark.yaml -l /Git/macOS-Security/custom/Images/cis_banner.png -p -x
</code></pre></div><p>Hope this will help you building your custom documentation based on CIS Benchmark &ldquo;Big Sur&rdquo;</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="/post/cis-script/">
                  <span class="button__icon">←</span>
                  <span class="button__text">CIS-Script</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="/post/eraseinstall/">
                  <span class="button__text">EraseInstall application retired</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">Powered by Hugo • Made with &#10084; © 2021 • MvdBent</div>
      
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
